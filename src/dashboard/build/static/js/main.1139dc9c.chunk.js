(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,n){e.exports=n(53)},53:function(e,t,n){"use strict";n.r(t);var a,r,l=n(0),u=n(22),c=n(55),o=n(56),i=n(57),s=n(6),m=n(7),p=n(9),h=n(8),g=n(10),b=n(13),d=n(11),E=n.n(d),f=Object(b.a)(a=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={gameName:"",startPage:1,endPage:void 0,task:null,selectType:"1"},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"runPoll",value:function(e){var t=this;this.sto=setTimeout(function(){e&&e(),t.runPoll(e)},1e3)}},{key:"handleSubmit",value:function(e){var t=this,n=this.state,a=n.gameName,r=n.startPage,l=n.endPage;e.preventDefault(),E.a.post("/api/task",{gameName:a,startPage:r,endPage:l}).then(function(e){0===e.data.error&&(alert("\u521b\u5efa\u6210\u529f\uff0c\u8bf7\u7b49\u5f85\u4efb\u52a1\u5355\u8fd0\u884c"),t.props.history.push("/"))})}},{key:"handleValueChange",value:function(e){var t={};t[e.target.name]=e.target.value,this.setState(t)}},{key:"render",value:function(){return l.createElement("section",{style:{textAlign:"center"}},l.createElement("h1",null,"\u521b\u5efa\u4efb\u52a1\u5355"),l.createElement("form",{onSubmit:this.handleSubmit},l.createElement("label",null,"\u6e38\u620f\u540d\uff1a\uff08\u8bf7\u8f93\u5165 dota2 \u6216\u8005 csgo\uff09"),l.createElement("input",{type:"text",onChange:this.handleValueChange,name:"gameName"}),l.createElement("br",null),l.createElement("br",null),l.createElement("label",null,"\u5f00\u59cb\u9875\u6570\uff1a\uff08\u722c\u53d6\u5f00\u59cb\u7684\u9875\u6570\uff0c\u4e00\u822c\u4e3a 1\uff0c\u5e73\u5747\u4e00\u98751500\u6761\u6570\u636e\uff09"),l.createElement("input",{type:"number",onChange:this.handleValueChange,name:"startPage"}),l.createElement("br",null),l.createElement("br",null),l.createElement("label",null,"\u7ed3\u675f\u9875\u6570\uff1a\uff08\u722c\u53d6\u7ed3\u675f\u7684\u9875\u6570\uff0c\u586b-1\u4e3a\u6700\u540e\u4e00\u9875\uff09"),l.createElement("input",{type:"number",onChange:this.handleValueChange,name:"endPage"}),l.createElement("br",null),l.createElement("br",null),l.createElement("button",{type:"onSubmit"},"\u5f00\u59cb    \uff01")))}}]),t}(l.Component))||a,v=Object(b.a)(r=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={dataSource:[],progressString:""},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("/api/task").then(function(t){var n=t.data[0];-1===n.status&&(e.runPoll(e.getTaskDetail(n._id)),e.progressInterval=setInterval(function(){e.setState(function(e){return{progressString:e.progressString+"."}})},1e3)),e.setState({dataSource:t.data})})}},{key:"componentWillUnmount",value:function(){clearInterval(this.progressInterval),clearTimeout(this.poll)}},{key:"runPoll",value:function(e){var t=this;this.poll=setTimeout(function(){e&&e(),t.runPoll(e)},2e3)}},{key:"getTaskDetail",value:function(e){var t=this;return function(){E.a.get("/api/task/".concat(e)).then(function(e){1===e.data.status&&(clearTimeout(t.poll),clearInterval(t.progressInterval),t.componentDidMount())})}}},{key:"renderStatus",value:function(e){switch(e){case-1:return"\u8fd0\u884c\u4e2d";case 0:return"\u8fd0\u884c\u5931\u8d25";case 1:return"\u6210\u529f\uff01"}}},{key:"handleExport",value:function(e){E.a.get("/api/task/".concat(e._id,"/export")).then(function(e){0===e.data.error&&location.reload()})}},{key:"renderResultUrl",value:function(e){if(1===e.status)return e.resultUrl?l.createElement("p",null,"\u6570\u636e\u4e0b\u8f7d\u94fe\u63a5\uff1a",l.createElement("a",{href:"/".concat(e.resultUrl)},e.resultUrl)):l.createElement("p",null,l.createElement("button",{onClick:this.handleExport.bind(this,e)},"\u5bfc\u51fa\u6570\u636e"))}},{key:"render",value:function(){var e=this,t=this.state,n=t.dataSource,a=t.progressString;return l.createElement("section",null,l.createElement("h1",null,"\u4efb\u52a1\u5355\u5217\u8868\uff1a"),n.length>0?n.map(function(t,n){return l.createElement("section",{style:{background:"#818181",margin:"20px 20px",color:"white"}},l.createElement("p",null,"\u63cf\u8ff0\uff1a",t.desc),l.createElement("p",null,"\u521b\u5efa\u65f6\u95f4\uff1a",new Date(t.createdAt).toLocaleTimeString()),l.createElement("p",null,"\u72b6\u6001\uff1a",e.renderStatus(t.status),0===n?a:null),1===t.status?l.createElement("p",null,"\u8017\u65f6\uff1a",t.timeConsuming):null,e.renderResultUrl(t))}):"\u8fd8\u6ca1\u6709\u4efb\u52a1\u5355\u6216\u8005\u4efb\u52a1\u5355\u5df2\u7ecf\u8fc7\u671f\u81ea\u52a8\u5220\u9664\uff0c\u70b9\u51fb\u53f3\u4e0a\u65b9\u53bb\u521b\u5efa\uff01")}}]),t}(l.Component))||r,y=n(54),k=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.createElement("div",null,l.createElement("nav",{style:{textAlign:"center",width:"100vw",margin:"0 0 50px 0"}},l.createElement(y.a,{to:"/",style:{margin:"0 30px "}},"\u5f53\u524d\u4efb\u52a1\u5355"),l.createElement(y.a,{to:"/create",style:{margin:"0 30px "}},"\u521b\u5efa\u65b0\u4efb\u52a1\u5355"),l.createElement(y.a,{to:"/subscribe",style:{margin:"0 30px "}},"\u9970\u54c1\u76d1\u542c")),this.props.children)}}]),t}(l.Component),j=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return"\u5f00\u53d1\u4e2d\uff01"}}]),t}(l.Component);u.render(l.createElement(c.a,null,l.createElement(o.a,null,l.createElement(k,null,l.createElement(i.a,{path:"/",exact:!0,component:v}),l.createElement(i.a,{path:"/create",component:f}),l.createElement(i.a,{path:"/subscribe",component:j})))),document.getElementById("root"),function(){return console.log("Page \u670d\u52a1\u5df2\u542f\u52a8")})}},[[25,2,1]]]);
//# sourceMappingURL=main.1139dc9c.chunk.js.map